<!doctype html><html lang=en><head><title>Scams targeting Google Groups :: Recyclebin.zip</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Scams targeting Google Groups"><meta name=keywords content="Blog,cyber security,security,infosec,cybersecurity,cloud security,technology,IT security"><meta name=robots content="noodp"><link rel=canonical href=https://recyclebin.zip/posts/2023-05-12-google-groups/><link rel=stylesheet href=https://recyclebin.zip/styles.css><link rel="shortcut icon" href=https://recyclebin.zip/img/theme-colors/red.png><link rel=apple-touch-icon href=https://recyclebin.zip/img/theme-colors/red.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Scams targeting Google Groups"><meta property="og:description" content="Scams targeting Google Groups"><meta property="og:url" content="https://recyclebin.zip/posts/2023-05-12-google-groups/"><meta property="og:site_name" content="Recyclebin.zip"><meta property="og:image" content="https://recyclebin.zip/img/favicon/red.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:published_time" content="2023-05-12 00:00:00 +0000 UTC"><link rel=me href=https:/irrelephant.co/g></head><body class=red><div class="container headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Recyclebin.zip</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/posts/index.xml>RSS</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/about>About</a></li><li><a href=/posts>Posts</a></li><li><a href=/posts/index.xml>RSS</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://recyclebin.zip/posts/2023-05-12-google-groups/>Scams targeting Google Groups</a></h1><div class=post-meta><time class=post-date>2023-05-12 ::
</time><span class=post-author>Guillaume Ross</span></div><div class=post-content><div><h1 id=scams-targeting-google-groups>Scams targeting Google Groups<a href=#scams-targeting-google-groups class=hanchor arialabel=Anchor>&#8983;</a></h1><p>This article was originally published on the <a href=https://fleetdm.com/blog/scams-targeting-google-groups>Fleet blog</a>. Minor style changes were applied.</p><p>The Fleet handbook contains detailed information on how we have configured Google Workspace <a href=https://fleetdm.com/handbook/security#email-security>to block spam and phishing</a>. Gmail has some exciting email security features, such as flagging or blocking mail from people with the same name as employees or quarantining it.</p><p>These features are great for protecting from business email compromise (BEC) and other types of social engineering attacks.</p><p>With this configuration, many of the less targeted, basic attempts at BEC get filtered, which is why an attempt we received a few weeks ago caught our attention.</p><p>Google Groups mailing lists have much weaker protection, and the Gmail security settings could create a false sense of security.</p><h2 id=attack-goal>Attack goal<a href=#attack-goal class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The attacker(s) seemed interested in obtaining copies of unpaid invoices from Fleet to our customers.</p><p>As this seems to have been attempted by a BEC group, we think they likely wanted to obtain unpaid invoices so they could trick our customers into paying an actual invoice into the wrong bank account.</p><p>Even people well trained against these types of scams could fall to it, especially if the actual invoice they receive is the one they expected all along!</p><p>To obtain these invoices, the attacker impersonated a salesperson. Salespeople requesting copies of invoices could make sense, as they are often paid commissions or bonuses on sales and might get in touch with clients to make sure invoices are well received.</p><h2 id=how-it-got-through>How it got through<a href=#how-it-got-through class=hanchor arialabel=Anchor>&#8983;</a></h2><p>As we have employee impersonation protection enabled, we were surprised that such a simple malicious email made it through the Gmail filters.</p><p>The attacker sent the message to a <em>group/mailing list</em>, not an individual. The email had a valid DKIM signature, as a real email account was used, with only the name spoofed.</p><p>Once Google Groups processes the email, it forwards it to internal and external recipients. Since Groups is the one sending the message, with a <em>from</em> that is now in the domain used for Google Workspace, the DKIM signature is valid. Internal recipients receive it without additional filtering, as it is a trusted internal email. External recipients receive it with a very high chance of delivery as the message is authenticated correctly and comes from a domain they interact with regularly.</p><p>From a UI point of view, the recipient can easily mistake the message for a legitimate one, as the domain name is either replaced with the legitimate domain or gets the mention &ldquo;via legitimatedomain.com&rdquo; added.</p><p>Our mistake was assuming the message went through the same filters used for regular email. In reality, Google Groups uses different technologies for filtering spam, and the more advanced Gmail features do not apply.</p><h3 id=email-processing>Email processing<a href=#email-processing class=hanchor arialabel=Anchor>&#8983;</a></h3><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph TD;
id1[Attacker]
id2[Malicious email]
id3[Group address]
id4[Internal recipients]
id5[External recipients]
id6[Gmail antispam/phishing]
id7[Google group weaker antispam/phishing]
id8[Email displayed with a group email address and employee name]

id1--Creates real email account with employee name--&gt;id2
id2--SPF and DKIM succeed--&gt;id7
id7--Email passes--&gt;id3
id3--Forwarded--&gt;id6
id6--Passes as it is now an internal email--&gt;id4
id6--Forwarded externally with new signature--&gt;id5
id5--&gt;id8
id4--&gt;id8
</code></pre><p>We contacted Google to ask why this message made it through filters. They confirmed that the filters are different on Groups vs Gmail (emphasis ours) in a response to our issue:</p><p>We then asked if any of the advanced spam filter rules from Gmail worked in Google Groups:</p><p>In this case, the attacker didn&rsquo;t spoof our domain, so enabling this feature did not help.</p><p>Two weeks after this happened, we saw a <a href="https://twitter.com/Centurion/status/1549780307544379392?s=20&amp;t=aehcFzyPfH_56fCLGpRddA">Tweet</a> by Chris Long at Material security, who had written a <a href=https://material.security/blog/identify-google-groups-vulnerable-to-spam-and-spoofing>blog post</a> on this topic.</p><p>Chris and Material tested and realized that Google Groups delivered five out of six types of spoofed emails while Gmail blocked all six. They also figured out why the original email was replaced with the mailing list email, as Google Groups replaced it when the DMARC policy caused the delivery to fail.</p><p>We performed the same tests at Fleet, using <a href=https://emailspooftest.com/>emailspooftest</a>. Our results were slightly different, but we successfully sent two very suspicious email messages to a mailing list. When we sent the same type of email to an individual, Gmail blocked each attempt.</p><h2 id=how-we-noticed-and-stopped-the-attack>How we noticed and stopped the attack<a href=#how-we-noticed-and-stopped-the-attack class=hanchor arialabel=Anchor>&#8983;</a></h2><p>At Fleet, we have excellent employees and contractors with amazing eyes for detail. We share information about potential scams, including phishing messages, over Slack, so the entire company is always aware of the suspicious stuff we see.</p><p>The person who received the email found it, if not necessarily suspicious, at least out of the ordinary. They contacted someone else to ask if that type of request was normal. This second person confirmed that it was not a genuine request and that, in any case, unpaid invoices should never be shared like this, even if the request came from an actual employee.</p><p>We communicate internally almost exclusively using Slack. Unlike email, impersonating someone on Slack would require compromising accounts configured with Two-Factor Authentication, making it a much more appropriate channel to discuss anything sensitive.</p><h2 id=recommendations>Recommendations<a href=#recommendations class=hanchor arialabel=Anchor>&#8983;</a></h2><ol><li>Warn and train all employees to be even more careful with mail sent to a mailing list, specifically that if an email is sent &ldquo;via&rdquo; your domain, it has a high probability of being spoofed.</li><li>Use a tool like <a href=https://emailspooftest.com/>emailspooftest</a> as recommended by Material Security to test your filters. Try a regular user, then a group. Adjust your assumptions.</li><li>Limit the number of Google Groups that can receive external emails.</li><li>Limit the number of internal users that can send emails &ldquo;on behalf&rdquo; of a group, to prevent legitimate emails from being sent &ldquo;via&rdquo; the group and makeing people accustomed to seeing them.</li><li>Avoid using common/obvious names for mailing lists.</li><li>Apply Material Security&rsquo;s <a href=https://material.security/blog/identify-google-groups-vulnerable-to-spam-and-spoofing>recommendation</a> to flag unauthenticated emails to groups.</li><li>Train your accounting teams to never respond to such requests via email but to contact individuals through a safer way, such as Slack.</li><li>Train your accounting teams to share files using services such as Google Drive, with explicit sharing to other employees within the domain. That way, even if someone agrees to give our fake salesperson access to invoices, the person who will get access is the actual employee.</li></ol><p><strong>Special request</strong>: If you use Google Workspace with Groups for mailing lists, please perform the <a href=https://emailspooftest.com/>emailspooftest</a> tests and open a support case with Google asking them to get Groups protection on par with Gmail. Without that happening, all the security we apply to individual accounts is moot unless you somehow have an entire company that does not need any mailing lists!</p><p>With the BEC cases explosion, we hope Google introduces more advanced spam filtering to Google Groups. We should not have to consider running email through a generic standard Gmail account and forwarding it from there instead of using Google Groups!</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://recyclebin.zip/posts/medium-posts-homekit-vlans/><span class=button__icon>←</span>
<span class=button__text>Using HomeKit Devices Across VLANs and Subnets</span>
</a></span><span class="button next"><a href=https://recyclebin.zip/posts/2023-05-12-bank-security/><span class=button__text>Securing bank accounts from business email compromise</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>©Guillaume Ross</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>